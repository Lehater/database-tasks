# Домашнее задание по дисциплине «Базы данных»

## Введение

Задачи, в данном домашнем задании, охватывают создание, наполнение и манипуляцию данными в различных базах данных.

В этом задании предстоит решить **13** задач, за которые можно получить в общей сложности **69 баллов.** Минимальный балл для успешного прохождения задания — **41.**

Работы выполняются с четырьмя различными базами данных:
- транспортные средства;
- автомобильные гонки;
- бронирование отелей;
- структура организации.

Каждая из баз данных включает в себя этапы создания таблиц, наполнения их данными, а также решение задач разной сложности, что позволит вам на практике применить полученные из модулей знания.

Каждая из представленных баз данных сопровождается скриптом, который создает таблицы базы данных и заполняет их тестовыми данными.


## Документация по структуре базы данных и реализованным функциям

### 1. Описание проекта
Проект представляет собой комплексную работу с реляционными базами данных, включающую создание, наполнение и выполнение запросов на выборку данных.  
Используется `PostgreSQL` с автоматическим развертыванием через `Docker Compose`.

---

### 2. Структура базы данных

Проект включает **четыре базы данных**, каждая из которых имеет свою предметную область:

#### 2.1. База данных `transport_vehicles` (Транспортные средства)
Содержит информацию о различных видах транспорта: **автомобили, мотоциклы, велосипеды**.  

**таблицы:**  
- `Vehicle` – информация о производителях и моделях транспортных средств.  
- `Car` – характеристики автомобилей (VIN, объем двигателя, мощность, трансмиссия).  
- `Motorcycle` – характеристики мотоциклов (VIN, мощность, объем двигателя, тип).  
- `Bicycle` – характеристики велосипедов (номер, количество передач, тип).  

---

#### 2.2. База данных `car_racing` (Автомобильные гонки)
Хранит информацию о гонках, классах автомобилей и их результатах.  

**таблицы:**  
- `Classes` – классы автомобилей (страна, тип, характеристики).  
- `Cars` – автомобили и их принадлежность к классу.  
- `Races` – данные о гонках (название, дата).  
- `Results` – результаты гонок (автомобиль, гонка, позиция).  

---

#### 2.3. База данных `hotel_booking` (Бронирование отелей)
Предоставляет данные о бронированиях номеров в отелях.  

**таблицы:**  
- `Hotel` – отели и их расположение.  
- `Room` – информация о номерах (тип, вместимость, цена).  
- `Customer` – данные о клиентах (ФИО, email, телефон).  
- `Booking` – записи о бронированиях (номер, клиент, даты заезда/выезда).  

---

#### 2.4. База данных `organization_structure` (Структура организации)
Отражает структуру сотрудников, их роли, проекты и задачи.  

**таблицы:**  
- `Departments` – информация об отделах.  
- `Roles` – роли сотрудников.  
- `Employees` – сотрудники, их должности и менеджеры.  
- `Projects` – проекты, связанные с отделами.  
- `Tasks` – задачи, назначенные сотрудникам.  

---

### 3. Реализованные SQL-функции и запросы

#### 3.1. [Анализ транспортных средств (`transport_vehicles`)](01.%20transport_vehicles/README.md)
- **Запрос 1:** Получение списка спортивных мотоциклов с мощностью >150 л.с. и ценой <20 000$.
- **Запрос 2:** Выборка всех автомобилей, мотоциклов и велосипедов, соответствующих заданным критериям, с сортировкой по мощности.

#### 3.2. [Анализ гонок (`car_racing`)](02.%20car_racing/README.md)
- **Запрос 1:** Определение автомобилей с наименьшей средней позицией в гонках.  
- **Запрос 2:** Определение автомобиля с лучшими показателями среди всех классов.  
- **Запрос 3:** Определение классов автомобилей с наименьшей средней позицией.  
- **Запрос 4:** Выбор автомобилей, у которых позиция лучше средней в классе.  
- **Запрос 5:** Определение классов с наибольшим количеством автомобилей с низкой позицией.  

#### 3.3. [Анализ бронирований (`hotel_booking`)](03.%20hotel_booking/README.md)
- **Запрос 1:** Поиск клиентов с более чем 2 бронированиями в разных отелях.  
- **Запрос 2:** Анализ клиентов, потративших более 500$, с учетом количества уникальных отелей.  
- **Запрос 3:** Определение предпочитаемых категорий отелей (дешевые, средние, дорогие) на основе средней стоимости номера.  

#### 3.4. [Анализ структуры организации (`organization_structure`)](04.%20organization_structure/README.md)
- **Запрос 1:** Выбор всех подчиненных (включая вложенные уровни) для сотрудника с `EmployeeID = 1` (рекурсивный запрос).  
- **Запрос 2:** Анализ сотрудников с их задачами, проектами и количеством подчиненных.  
- **Запрос 3:** Поиск менеджеров с подчиненными и назначенными задачами.  

---

### 4. Автоматическое развертывание с Docker
Все базы данных автоматически создаются и наполняются тестовыми данными при первом запуске `PostgreSQL` в `Docker`.

Файлы хранятся в `init-scripts/` и выполняются при старте контейнера:

- `01_create_databases.sql` – создание баз данных.  
- `02_transport_vehicles.sql` → `05_organization_structure.sql` – наполнение таблиц данными.  

Запуск контейнера:
```bash
docker-compose up -d
```
УЗ для подключения к БД:
user: `user`
password: `password`